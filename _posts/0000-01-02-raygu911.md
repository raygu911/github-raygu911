layout: SQL Server
title: "Deduplicate"
---
SELECT SourceTable, SevenDigitFlag, queuenumber, spt2_switch_id, suborigin, COE_Handled, SPT2_Call_Source_id, CALLID, SEGMENT, ANI, SEGSTART_D, SEGSTOP_D, DISPSPLIT, ACD, DISPOSITION, UCID, DISPVDN, ORIGLOGIN, ANSLOGIN, DIALED_NUM, CALLING_PTY, ASAIUUI, spt2_Agent_Skill_id, spt2_agent_center_id, call_date, calls_handled, calls_abandoned, short_abandons, handled_sl, handled_aht, handled_asa, handled_TalkTime, handled_HoldTime, handled_WrapTime, handled_QueueTime, handled_RingTime, TRANSFERRED, status_date, spt2_locationgroup_id, calls_xfer_out, calls_conference, total_calls_out, conference, agt_released, UUIformatId, UUIaccountNumber, UUIaniCed, UUIacctVerification, UUIcallType, UUIdialedNumber, UUIuid, UUIivrData, UUIzip, UUIcustomerSurvey, UUIscreenPop, UUItechId, UUIjobId, UUItechName, spt2_CustomerRegion_ID, spt2_CustomerDivision_ID, legalHold
,COUNT(1) AS RowCount
FROM aceyus_hds.dbo.consolidatedCallDetail
GROUP BY SourceTable, SevenDigitFlag, queuenumber, spt2_switch_id, suborigin, COE_Handled, SPT2_Call_Source_id, CALLID, SEGMENT, ANI, SEGSTART_D, SEGSTOP_D, DISPSPLIT, ACD, DISPOSITION, UCID, DISPVDN, ORIGLOGIN, ANSLOGIN, DIALED_NUM, CALLING_PTY, ASAIUUI, spt2_Agent_Skill_id, spt2_agent_center_id, call_date, calls_handled, calls_abandoned, short_abandons, handled_sl, handled_aht, handled_asa, handled_TalkTime, handled_HoldTime, handled_WrapTime, handled_QueueTime, handled_RingTime, TRANSFERRED, status_date, spt2_locationgroup_id, calls_xfer_out, calls_conference, total_calls_out, conference, agt_released, UUIformatId, UUIaccountNumber, UUIaniCed, UUIacctVerification, UUIcallType, UUIdialedNumber, UUIuid, UUIivrData, UUIzip, UUIcustomerSurvey, UUIscreenPop, UUItechId, UUIjobId, UUItechName, spt2_CustomerRegion_ID, spt2_CustomerDivision_ID, legalHold
HAVING COUNT(1) > 1

